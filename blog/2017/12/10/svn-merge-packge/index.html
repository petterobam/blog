<!DOCTYPE html>

<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!-->
<html class="no-js" lang="zh">
<!--<![endif]-->

<head>
    <meta charset="utf-8">
<!--[if IE]><meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'><![endif]-->
<meta name="viewport" content="width=device-width,initial-scale=1">

<!-- Begin Jekyll SEO tag v2.6.1 -->
<title>关于代码提交、定版合并和打单包总结 | 欧阳Boy_Petter&#39;s Blog</title>
<meta name="generator" content="Jekyll v3.5.2" />
<meta property="og:title" content="关于代码提交、定版合并和打单包总结" />
<meta name="author" content="欧阳Boy_Petter" />
<meta property="og:locale" content="zh" />
<meta name="description" content="SVN 提交经验分享" />
<meta property="og:description" content="SVN 提交经验分享" />
<meta property="og:site_name" content="欧阳Boy_Petter&#39;s Blog" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2017-12-10T00:00:00+00:00" />
<script type="application/ld+json">
{"author":{"@type":"Person","name":"欧阳Boy_Petter"},"description":"SVN 提交经验分享","@type":"BlogPosting","url":"/blog/2017/12/10/svn-merge-packge/","headline":"关于代码提交、定版合并和打单包总结","dateModified":"2017-12-10T00:00:00+00:00","datePublished":"2017-12-10T00:00:00+00:00","mainEntityOfPage":{"@type":"WebPage","@id":"/blog/2017/12/10/svn-merge-packge/"},"@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

<meta name="keywords" content="代码提交,代码合并,打包" />





<link type="application/atom+xml" rel="alternate" href="/feed.xml" title="欧阳Boy_Petter's Blog" />
    <link href='/assets/stylesheets/blog.css' rel="stylesheet" type="text/css">
    <script src="//cdnjs.cloudflare.com/ajax/libs/modernizr/2.8.3/modernizr.min.js"></script>
<script>window.Modernizr || document.write('<script src="/assets/javascripts/modernizr-2.8.3.min.js"><\/script>')</script>

<script src="//cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<script>
    window.jQuery || document.write('<script src="/assets/javascripts/jquery-3.2.1.min.js"><\/script>')
</script>

<script src="//cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/pace.min.js"></script>
<script>
    window.Pace || document.write('<script src="/assets/javascripts/pace.min.js"><\/script>')
</script>


</head>

<body>
    <!--[if IE]>
    <p class="site-notice">您正在使用一个过时的网页浏览器。请<a href="http://browsehappy.com/" target="_blank">升级您的浏览器</a>或<a href="http://www.google.com/chromeframe/?redirect=true" target="_blank">开启 Google Chrome Frame</a> 来提高用户体验。</p>
<![endif]-->
<noscript>
    <p class="site-notice">本网站需要 JavaScript。请查阅指南来<a href="http://www.enable-javascript.com/" target="_blank">给您的浏览器开启 JavaScript 功能</a>。</p>
</noscript>

    <div class="nav-wrapper overlay-wrapper">
    <div class="nav-form overlay-form">
        <span class="overlay-header menu">菜单</span>
        <a class="btn-close">关闭</a>
        <div class="results">
            <ul>
                <li><a href="/blog/">文章</a></li>
                <li><a href="/blog/categories/">分类</a></li>
                <li><a href="/blog/tags/">标签</a></li>

                <li><a href="/blog/reader/">读书</a></li>
                <li><a href="/blog/movie/">影音</a></li>
                <li><a href="/blog/book+movie/">书&影</a></li>

                <li><a href="/blog/learner/">笔记</a></li>
                <li><a href="/blog/life/">动态</a></li>
                <li><a href="/blog/letter/">信</a></li>
                <li><a href="/blog/song/">歌</a></li>
                <li><a href="/blog/story/">文</a></li>
                <li><a href="/blog/plan/">业</a></li>
                <li><a href="/blog/family/">家</a></li>
                <li><a href="/blog/other/">杂</a></li>
                <li><a href="/">关于</a></li>
            </ul>
        </div>
    </div>
</div>

<div class="search-wrapper overlay-wrapper">
    <div class="search-form overlay-form">
        <input type="text" class="overlay-header search-field" placeholder="搜索...">
        <a class="btn-close">关闭</a>
        <ul class="results"></ul>
    </div>
</div>


    <div id="page" class="hentry">
        <header class="the-header">
    <div class="unit-head">
        <div class="unit-inner unit-head-inner">
            <nav class="nav-global">
                <ul>
                    <li class="logo">
                        <button class="btn-menu" title="菜单"></button>
                        <a href="/blog/">欧阳Boy_Petter's Blog</a>
                        <!--[if !IE]> -->
                        <button class="btn-search" title="搜索"></button>
                        <!-- <![endif]-->
                    </li>
                    <li class="nav-link"><a label="article" title="文章" href="/blog/">文章</a></li>

                    <!-- <li class="nav-link"><a label="book" title="读书" href="/blog/reader/">读书</a></li> -->
                    <!-- <li class="nav-link"><a label="movie" title="影音" href="/blog/movie/">影音</a></li> -->
                    <li class="nav-link"><a label="book+movie" title="书&影" href="/blog/book+movie/">书&影</a></li>
                    
                    <li class="nav-link"><a label="learn" title="笔记" href="/blog/learner/">笔记</a></li>
                    <li class="nav-link"><a label="life" title="动态" href="/blog/life/">动态</a></li>
                    <li class="nav-link"><a label="letter" title="信" href="/blog/letter/">信</a></li>
                    <li class="nav-link"><a label="song" title="歌" href="/blog/song/">歌</a></li>
                    <li class="nav-link"><a label="story" title="文" href="/blog/story/">文</a></li>
                    <li class="nav-link"><a label="plan" title="业" href="/blog/plan/">业</a></li>
                    <li class="nav-link"><a label="family" title="家" href="/blog/family/">家</a></li>
                    <li class="nav-link"><a label="other" title="杂" href="/blog/other/">杂</a></li>
                    <!--[if !IE]> -->
                    <li class="nav-link"><a title="搜索" class="btn-search" href="#">搜索</a></li>
                    <!-- <![endif]-->
                </ul>
            </nav>
        </div>
    </div>
</header>


        <div class="body animated fadeInDown" role="main">
            <div class="unit-body">
                <div class="unit-inner unit-body-inner">
                    <div class="entry-content">
                        <article id="article-content" class="unit-article layout-post">
    <div class="unit-inner unit-article-inner">
        <div itemscope itemtype="http://schema.org/Article" class="content">
            <header>
                <div class="unit-head">
                    <div class="unit-inner unit-head-inner">
                        <h1 class="entry-title" itemprop="name">关于代码提交、定版合并和打单包总结</h1>
                    </div>
                </div>
            </header>
            <div class="bd article-content">
                <div class="entry-content">
                    <div class="meta">
                        <p class="date-publish">
                            发表信息:
                            <time itemprop="datePublished" class="date-pub updated"
                                title="2017-12-10T00:00:00+00:00" datetime="2017-12-10T00:00:00+00:00">December 10, 2017 </time>
                            by
                            <a class="author" href="/" rel="author" title="显示作者">
                                <span itemprop="author" itemscope itemtype="http://schema.org/Person">
                                    <span itemprop="name">欧阳Boy_Petter</span>
                                </span>
                            </a>
                            
                                <a class="license-icon" rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/" target="_blank" title="显示许可证">
                                    <img alt="Creative Commons Licence" style="border-width:0" src="/assets/images/theme/cc-by-sa.png"  height="16" width="80"/>
                                </a>
                            
                            
                        </p>
                        


<p style="margin-top: 0px;margin-bottom: 0px;">
  字数：572 字，&nbsp;预计阅读时间：5 分钟
</p>
                        
                        <ul class="list-category list-linear">
                            <li class="list-head">分类: </li>
                             
     
        <li>
            <a href="/blog/categories/#SVN" title="SVN">
            SVN <span>1</span></a>
        </li>
     
        <li>
            <a href="/blog/categories/#体会" title="体会">
            体会 <span>4</span></a>
        </li>
    



                        </ul>
                        
                        
                        <ul class="list-tag list-linear">
                            <li class="list-head">标签: </li>
                             
    
        
        <li>
            <a href="/blog/tags/#代码合并" title="代码合并">代码合并 <span>1</span></a>
        </li>
    
        
        <li>
            <a href="/blog/tags/#代码提交" title="代码提交">代码提交 <span>1</span></a>
        </li>
    
        
        <li>
            <a href="/blog/tags/#打包" title="打包">打包 <span>1</span></a>
        </li>
    




                        </ul>
                        
                    </div>
                    <div id="articleBody" itemprop="articleBody">
                        <h2 id="heading-前情提要">前情提要</h2>

<p>鉴于最近公司旅游及同学聚会，琐事蛮多，疏于记录，特提笔写写最近的东西。</p>

<p>背景：前些日子，公司核心产品终测环境打包编译屡屡出问题，特此做一些通用总结。</p>

<h2 id="heading-代码提交">代码提交</h2>

<h3 id="heading-每次提交的最小单位是安全的整体逻辑或弱关联文本">每次提交的最小单位是安全的整体逻辑或弱关联文本</h3>

<p>愿我们每个人都将代码提交演绎为一项神圣的仪式，了解提交的魅力。</p>

<div class="highlighter-rouge"><pre class="highlight"><code>安全：不影响启动的逻辑、不影响原先业务的逻辑。
整体逻辑：保证不随意提交零散代码。整体提交能保证安全，拆开提交则有隐患。
弱关联文本：新增文件的时候，弱关联文本单独提交无隐患。
</code></pre>
</div>

<h4 id="heading-整体逻辑定义">整体逻辑定义</h4>

<ul>
  <li>
    <p>1）一个业务功能</p>
  </li>
  <li>
    <p>2）一个服务功能</p>
  </li>
  <li>
    <p>3）单个 bug 的处理</p>
  </li>
  <li>
    <p>4）其他</p>

    <p>代码层面上逻辑闭合（基于 SVN 上已有的类的引用，做的一整套修改）以 ASMS 为例：</p>

    <ul>
      <li>如果你<span style="color:red">修改</span>的是 controller，则你需要检查对应的页面</li>
      <li>如果你<span style="color:red">修改</span>的是一个 service，则你需要检查引用这个 service 的其他 service 和 controller；</li>
      <li>如果你<span style="color:red">修改</span>的是一个<span style="color:red">dao</span>，则你需要检查对应的 Mapper 和 service；</li>
      <li>如果你<span style="color:red">修改</span>的是一个<span style="color:red">Mapper</span>，则你需要检查对应的<span style="color:red">数据库环境</span>、dao 和 service；</li>
      <li>如果你<span style="color:red">修改</span>的是一个<span style="color:red">entity</span>（关联表的 JavaBean），则你需要检查<span style="color:red">所有</span>。</li>
    </ul>
  </li>
</ul>

<p>当然，这些检查并不是真的要跑到每个地方去看，我们要善于利用 intellij 的编译工具和我们的经验，保证代码编译逻辑正确（启动）、业务逻辑正确（需求落实）、功能逻辑正确（需求落实+异常处理）</p>

<h4 id="heading-弱关联文本的定义">弱关联文本的定义</h4>

<p>所谓的弱关联文本，就是不依赖或仅仅依赖于原来 SVN 的环境，不依赖于任何新的文件的文本，他们都可以直接提交。</p>

<ul>
  <li>
    <p>纯粹的弱关联文本</p>

    <ul>
      <li>1) 你<span style="color:red">新增</span>了一个 JavaBean，并且引用的类和方法是原先 SVN 仓库里面已经有的，这样的 JavaBean 可以单独提交；</li>
      <li>2) 你<span style="color:red">新增</span>了一个 js、css 或 icon 等 static 里面的静态文本，这些可以先单独提交。</li>
    </ul>
  </li>
  <li>
    <p>有前提条件下的弱关联文本</p>

    <ul>
      <li>1)<span style="color:red">不影响启动的前提下</span>，所有的 static 和 view 下吗的文件都是弱关联文本。</li>
    </ul>
  </li>
</ul>

<h4 id="heading-强关联文本的定义">强关联文本的定义</h4>

<p>有弱关联文本必有对应的强关联文本，这些东西的提交一定要有个概念。</p>

<ul>
  <li>
    <p>1）所有于数据库交互的文本（<span style="color:red">Mapper、Entity</span>）或于数据库中间件交互的文本（<span style="color:red">Dao</span>）都是强关联文本，他们的新增都需要进行规范的检查，步骤从（数据库环境=&gt;Entity[与数据库对应的 JavaBean]=&gt;Mapper=&gt;Dao=&gt;编译=&gt;<span style="color:red">启动自测</span>）；</p>
  </li>
  <li>
    <p>2）所有使用到其他项目的类的类都是强关联文本，比如实现继承、spring 注入、JavaBean 引入实体等，需要进行规范的检查（[确认 Mvn 的版本是最近的，至少是三天以内的]=&gt;编译=&gt;<span style="color:red">启动自测</span>）；</p>
  </li>
  <li>
    <p>3）所有<span style="color:red">系统配置文件</span>都是强关联文本，包括<span style="color:red">property</span>、source 下的<span style="color:red">xml</span>文件和 maven 工程的<span style="color:red">pom</span>文件，这些文档的提交需要找组长和对应的技术经理，系统框架级别的要找 CTO 的确认，禁止单独提交。</p>
  </li>
</ul>

<h3 id="heading-每次提交都要遵照标准的提交步骤">每次提交都要遵照标准的提交步骤</h3>

<h4 id="heading-提交代码前的最低标准">提交代码前的最低标准</h4>

<ul>
  <li>1)<span style="color:red">所在环境编译无误</span></li>
  <li>2) 最高标准：所在环境启动无误，并且代码彻底解决了某个 bug、完全实现了某个功能</li>
</ul>

<h4 id="heading-小乌龟操作步骤">小乌龟操作步骤</h4>

<ul>
  <li>
    <p>1) 更新你要提交的项目的代码（如有冲突，请先解决冲突，并返回 1.2.1）</p>
  </li>
  <li>2)Commit 预览，预览时要确定两点：
    <ul>
      <li>
        <p>a) 要提交的文件的数量</p>

        <p>注：在排除了配置文件后的文件数量，配置文件找组长和技术经理提交</p>
      </li>
      <li>
        <p>b) 检查每个你要提交的 java 文件和 Mapper 文件，修改的地方是否是你的代码，避免提交他人的代码</p>

        <p>注：java 文件要特别注意导入的包，很多情况下是导入了无用的包，导致了代码的问题，可以对自己的 intellij idea 做如下设置</p>
      </li>
    </ul>

    <p><img src="https://cdn.jsdelivr.net/gh/petterobam/picture-bucket@main/oyjie.cn/upload/2017/12/qjtsinc654j8mqb0u2rnorq1nd.png" alt="自动导包设置" /></p>

    <blockquote>
      <p>勾选标注 1 选项，IntelliJ IDEA 将在我们书写代码的时候自动帮我们优化导入的包，比如自动去掉一些没有用到的包。 <br />
勾选标注 2 选项，IntelliJ IDEA 将在我们书写代码的时候自动帮我们导入需要用到的包。但是对于那些同名的包，还是需要手动 Alt + Enter 进行导入的<br />
<span style="color:red">一般勾选标注 1 即可</span>，标注 2 不勾选，有利于我们在编程的时候了解一些工具类的路径，这是一个即时学习的过程。</p>
    </blockquote>
  </li>
  <li>
    <p>3) 写好备注</p>

    <ul>
      <li>a) 如果是 bug，请附上 bug 的标题及 ID，详细可以追加产生原因和处理方案，总结的过程，提升贼快；</li>
      <li>b) 如果是需求，请附上需求说明，及该批代码完成了需求的哪一块；</li>
      <li>c) 如果是其他功能，请附上功能描述，及完成了该功能的哪一块；</li>
      <li>d) 如果是其他，请附上明确备注</li>
    </ul>
  </li>
  <li>4) 提交，并跟进相关环境的更新情况，及时查看代码影响的模块，自测。</li>
</ul>

<h4 id="heading-提交情况告知组长">提交情况告知组长</h4>

<p>组长有义务监督组员代码的提交，特别是定版的代码提交，但是提交过程何其多，组长无法一一顾及，所以需要组员主动汇报组长自身提交的动态，不然出了问题组长会很不爽哦。</p>

<p><span style="color:red">提交完开发环境</span>，需要告知组长，可以简单的发个消息，告知你提交的版本、描述和时间。</p>

<p>当然，个人建议可以用通讯工具建立一个组内代码提交动态群，组长可以浏览每天的提交动态。</p>

<p><img src="https://cdn.jsdelivr.net/gh/petterobam/picture-bucket@main/oyjie.cn/upload/2017/12/1hoihoum3ugcrqqhos1akaq7hu.png" alt="组内代码提交群" /></p>

<h2 id="heading-定版合并">定版合并</h2>

<p>SVN 开发版本到定版的代码迁移过程，称为定版合并过程。</p>

<h3 id="heading-定版合并先决条件">定版合并先决条件</h3>

<h4 id="heading-保证合并的代码来源无误">保证合并的代码来源无误</h4>

<p>开发版的代码需要满足解决了某个 bug，完成了某个需求，实现了某个功能，并测试通过。</p>

<h4 id="heading-待合并的版本清单">待合并的版本清单</h4>

<p>清楚要合并的代码在开发版上的提交版本清单，需要合并哪些提交记录，才能组成一个逻辑整体。</p>

<h4 id="heading-明确清楚合并顺序">明确清楚合并顺序</h4>

<p>当出现多个模块合成一个整体逻辑的时候，明确清楚合并顺序。例如修改了 OpenApi，如果有其他的合作项目，则其他项目的合并在前。</p>

<h3 id="heading-定版合并步骤">定版合并步骤</h3>

<p>定版合并前一定要保证开发版代码正确，否则合并定版就如同一场儿戏。</p>

<h4 id="heading-merge-的原则和原理">Merge 的原则和原理</h4>

<p>Merge 是一个代码选择性拷贝的过程，了解其原理有助于我们更流畅的 Merge，减少发生冲突的次数及减轻对冲突的恐惧。</p>

<ul>
  <li>
    <p>1) 先更新你需要提交的项目目录。</p>

    <p>只要你的本地代码在版本中，更新必定不会产生冲突。定版代码我们都不会手动在上面编辑，所以更新的时候不会与你的定版代码冲突，如有冲突，说明你对本地的定版代码做了编辑修改，这个时候只需要还原整个项目的代码，在进行更新即可。</p>
  </li>
  <li>
    <p>2) 选择对应的远程版本，Merge 预览</p>

    <p>少量的代码合并很容易 Merge，但也不能轻视，往往就是这种情况让我们掉以轻心。</p>

    <p>大量代码的合并可能让我们疲于应付，但是 Merge 只是一个代码远程 Copy 的过程，这里可以简单的分享一些技巧。</p>

    <p>背景 1：例如，你最近半个月都在做一个需求项目，并且你们组的其他人也全部参与其中，在这期间你的组员可能还时不时改改其他业务 bug，但是跟这个新项目有关的东西在没做完前都只能提交开发的 SVN。这种情况下，我就会定下规矩，关于新需求项目的代码提交备注统一添加前缀——XXXXX 项目：[你的 SVN 备注]。如此一来，半个月之后，项目开发完成后，需要在终测上测试了，这个时候我利用 Merge 预览就可以轻松找到我要合并的代码，而这些代码集合就是这个项目的整体逻辑，高效、完美。</p>

    <ul>
      <li>a. 通过<span style="color:red">Next 100</span>按钮调整你的项目开始时间 From&lt;/span&gt;</li>
      <li>b. 通过小乌龟的通配搜索功能，记住使用正则功能一定要勾选 <span style="color:red">use regular expression</span></li>
      <li>c. 有些备注模糊不清的地方，组长需要找到对应的组员确认，<span style="color:red">并纠正告诫</span></li>
    </ul>

    <p><img src="https://cdn.jsdelivr.net/gh/petterobam/picture-bucket@main/oyjie.cn/upload/2017/12/3i7nfqp7vkjd7qs1461v4g6ov0.png" alt="svn 的 merge 示例" /></p>
  </li>
</ul>

<p>然后，开始 Merge，庆幸的是该项目的 Merge 没有出现任何冲突，虽然归功于良好的注释和整体逻辑的提交原则，但是这并不意味着不会出现冲突的 Merge 情况了。</p>

<p>往往一个项目时长越长，业务关联越多，可能出现的问题也会越多，牵扯到的业务越多，交叉修改文件的频率也会越频繁，这样通过搜索出来的的文件很大概率跨了很多未合并的版本。</p>

<p>例如，我在版本里面随机选择一些版本进行合并</p>

<p><img src="https://cdn.jsdelivr.net/gh/petterobam/picture-bucket@main/oyjie.cn/upload/2017/12/vjvk33sq74iajologp27rhem3h.png" alt="随机代码合并" /></p>

<p>这种文件树的冲突，一般指文件夹，就算是文件也可以直接不管，标记为已解决即可</p>

<p><img src="https://cdn.jsdelivr.net/gh/petterobam/picture-bucket@main/oyjie.cn/upload/2017/12/slmsm4v218j9mrjfu7jfmvbrrf.png" alt="文件夹冲突" /></p>

<p>像这种文件类的冲突，如果你不擅长或不确定如何 Edit conflict，可以先选择合并接收开发版本的 SVN 最新版，快速完成 Merge 的过程，并且确保你的代码能过来是最重要的。</p>

<p><img src="https://cdn.jsdelivr.net/gh/petterobam/picture-bucket@main/oyjie.cn/upload/2017/12/23oi0ni1mqggbpfhdmond8ftac.png" alt="文件冲突" /></p>

<p>这样，你的代码就“毫无 Conflict”的情况下 Merge 到了本地的定版，这样就结束了吗？</p>

<p>No，上面都是无关紧要的必要步骤，下面的才是重中之重。</p>

<h4 id="heading-有意识的检查">有意识的检查</h4>

<p>检查是一项很枯燥的工作，很容易让人失去耐性，但是如果是有意识的检查，有明确的目标，那么这项工作就变得流畅而富于意义，至少对于当时的你是这样的。</p>

<p>首先打开你 Merge 的项目的提交预览界面，不要写提交备注</p>

<p>预览要确定的一些东西，即目标：</p>

<ul>
  <li>
    <p>a) 要提交的文件的数量</p>

    <p>注：在排除了配置文件后的文件数量，配置文件找组长和技术经理提交</p>
  </li>
  <li>
    <p>b) 检查每个你要提交的 java 文件和 Mapper 文件</p>

    <p>注：确定修改的地方是你的代码。</p>
  </li>
  <li>
    <p>c)<span style="color:red">重点检查 Merge 过程中发生过冲突的文件</span></p>

    <p>注：这样的文件必定是少量，如果有很多，你就要慎重一点了，找找原因你会发现，可能有正在 130 测试中的需求没有合并到定版，也可能会有很久远的代码没有合并到定版了，然后幸运的被你发现了，<span style="color:red">解决他</span>。</p>
  </li>
</ul>

<p><strong>提问：如果 Merge 过程中，没有出现一次 <span style="color:red">Conflict</span> 的提示，是不是意味着可以绝对不会有问题？</strong></p>

<blockquote>
  <p>答：不是。这只能说明你 Merge 的代码一定是你提交的那些代码，如果是一个整体逻辑，那确实没有问题，可是问题是可能不是一个整体逻辑，比如出现 1.2.2 中你提交到开发版有<span style="color:red">import</span>无用的包，恰好你没有设置自动清除无用的包，而这个依赖的类在定版正好没有，那你的这次提交就是一个<span style="color:red">伪整体逻辑</span>，就会导致定版启动异常。</p>
</blockquote>

<p>如何判断你的每一次提交是否是整体逻辑呢？下面的步骤才是无罪证书获取流程。</p>

<h4 id="heading-编译都没问题了那才是没问题">编译都没问题了，那才是没问题</h4>

<p>我们用 intellij idea 打开我们定版的工程：</p>

<ul>
  <li>1) 确保你定版的 idea 工程的 Maven 是三天以内的版本（看 overlay 里面的子项目时间）。</li>
  <li>2) 确保 idea 工程的每个 Module 是最新的，不是就更新。</li>
</ul>

<p>打开 idea 工程的 Maven Projects，展开你要提交的子项目的 lifecycle，clear、compile，
<span color="blue">Process finished with exit code 0</span> 代表你可以喝口茶了。</p>

<p>最后，提交代码，再次简单检查一下，写好备注，提交代码，并实时关注终测环境的更新状态，确保你提交的代码不但安全，并且有效（满足了需求？解决了问题？实现了功能？）。</p>

<h2 id="heading-定版打单包">定版打单包</h2>
<p><span style="color:red">如果是用于终测或客户环境，请在本地定版打单包</span>。</p>

<h3 id="heading-定版打包的先决条件">定版打包的先决条件</h3>

<ul>
  <li>1) 保证定版 idea 项目 Maven 是三天以内</li>
  <li>2) 保证你要打包的子项目 Maven 编译无误</li>
</ul>

<h3 id="heading-定版打包的技巧">定版打包的技巧</h3>

<h4 id="heading-定版打单包的痛点">定版打单包的痛点</h4>

<p><strong><span size="20px">慢！</span></strong></p>

<p>借助我们原来的打包工具</p>

<p>和与 tomcat 一致的子目录</p>

<p><img src="https://cdn.jsdelivr.net/gh/petterobam/picture-bucket@main/oyjie.cn/upload/2017/12/6e36b3aj6ii6cr09jcph8npa99.png" alt="tomcat 发布包" /></p>

<p>请问你要什么样的包，我都可以给你。</p>

<p>定版打包让人比较难受的是，编译启动太耗时间，然而这往往是喜欢从主项目（例如 ASMS10000 的 asms-web）的 target 目录下打包的人的烦恼，当然这种情况打的包自然是没问题，但是要全部编译并发布到主项目 target 太耗时，特别是我们的核心产品的项目。</p>

<p>但是回头想想，为啥当初要将一个项目分离成这么多个项目，不就是为了降低不同组之间的相互影响，如果每个组自身的代码没有 problem，那么整个项目就理应 No problem。同理，打包原理也是类似，可以分离打包，基于 tomcat 的特性，我们如果能够创造那样的目录结构和所需的文件，借助打包工具，往往会事半功倍呢。</p>

<h4 id="heading-定版打单包的技巧">定版打单包的技巧</h4>

<ul>
  <li>
    <p>1) 在桌面创建一个文件夹</p>

    <p><img src="https://cdn.jsdelivr.net/gh/petterobam/picture-bucket@main/oyjie.cn/upload/2017/12/pbumj6iq4sjnioqhh06mr579m2.png" alt="打包区" /></p>
  </li>
  <li>
    <p>2) 将你要打包的定版子项目 webapp 文件夹下的文件夹拷入其中</p>

    <p><img src="https://cdn.jsdelivr.net/gh/petterobam/picture-bucket@main/oyjie.cn/upload/2017/12/774mlo5nbkhs3ra142t0t02alk.png" alt="子项目目录" /></p>

    <p><img src="https://cdn.jsdelivr.net/gh/petterobam/picture-bucket@main/oyjie.cn/upload/2017/12/54o0qq6iregvap1fu7c7a3cd65.png" alt="打包子项目" /></p>

    <p>当然，如果你打包的项目里面没有 static 类的文件可以不拷贝 static 文件夹，如果没有 view 类文件，课可以不拷贝 WEB-INF 文件，直接新建一个 WEB-INF 文件夹即可</p>
  </li>
  <li>
    <p>3) 在 idea 定版项目上 Maven clear、compile 你的子项目</p>

    <p><img src="https://cdn.jsdelivr.net/gh/petterobam/picture-bucket@main/oyjie.cn/upload/2017/12/5g5r10utkihfaok3silof1fg0m.png" alt="子项目编译" /></p>
  </li>
  <li>
    <p>4) 确保编译无误后，将你要提交的项目下的 target 文件下的 classes 文件夹拷入 WEB-INF 目录中</p>

    <p><img src="https://cdn.jsdelivr.net/gh/petterobam/picture-bucket@main/oyjie.cn/upload/2017/12/ptngqv77vehocpuga81lvpc0oi.png" alt="子项目编译结果" /></p>
  </li>
  <li>
    <p>5) 然后就创造了单个子项目的打包环境</p>

    <p><img src="https://cdn.jsdelivr.net/gh/petterobam/picture-bucket@main/oyjie.cn/upload/2017/12/pphm6r3he2hgjo9gpv8oke257k.png" alt="项目打包区" /></p>
  </li>
  <li>
    <p>6) 根据提交记录打包</p>

    <p><img src="https://cdn.jsdelivr.net/gh/petterobam/picture-bucket@main/oyjie.cn/upload/2017/12/pfphd8dp0ehsep0befqrjnel1p.png" alt="SVN 提交日志" /></p>

    <p>注：如果文件成批的在某个文件夹内，可以批量的拖进打包工具。</p>
  </li>
</ul>


                    </div>
                </div>
            </div>
            <footer class="unit-foot">
                <div class="unit-inner unit-foot-inner">
                    <div class="post-buttons">
                        <a class="internal gotop" href="#page" title="返回顶部">返回顶部</a>
                        
                    </div>
                    <nav class="pagination">
                        
                            <a class="internal" rel="prev" href="/blog/2017/11/06/Word-PDF-Parse-2/" title="上一篇 'Word、PDF 解析项目（二）'"> ← Word、PDF 解析项目（二）</a>
                        
                        
                            <a class="internal" rel="next" href="/blog/2018/02/21/sqlite-db-oop/" title="下一篇 '数据库面向对象封装【干货】'">数据库面向对象封装【干货】 → </a>
                        
                    </nav>
                </div>
            </footer>
        </div>
    </div>
</article>
<!-- 评论组件 -->
<!-- 聚合所有评论组件 -->

<div class="misc-content">

<!-- emaction -->

<div style="margin-top: 10px;color: coral;border-top: 1px solid;border-bottom: 1px solid;">
<div style="float:left;">邀请标记你的阅读体验😉 ｜ → &nbsp;</div>
<emoji-reaction></emoji-reaction>
<div style="clear:both;"></div>
</div>
<script type="module" src="https://cdn.jsdelivr.net/gh/emaction/frontend.dist@1.0.7/bundle.js"></script>

<script type="text/javascript">
    $(document).ready(function() {
        $($("emoji-reaction")[0].shadowRoot).find("div.container").css("align-items","center");
    });
</script>

<!-- gitment -->

<!-- utterances -->

<script src="https://utteranc.es/client.js"
    repo="petterobam/blog"
    
    issue-number="6"
    
    theme=""
    crossorigin="anonymous"
    async></script>


</div>
<!-- 悬浮目录组件 -->


<style type="text/css">
.directory-content{font-size:15px;line-height:28px;position:relative;z-index:20;max-width:1000px;margin-right:auto!important;margin-left:auto!important;text-align:right}
.directory-content.initial{opacity:0}
.directory-content.pinned{opacity:1}
.directory-content.unpinned{opacity:1}
.directory-content.headroom--top{opacity:0}
.directory-content.headroom--not-top{-webkit-transition:opacity .5s ease-in-out;transition:opacity .5s ease-in-out;opacity:1}
#directory{position:fixed;z-index:20;top:37px;right:45px;display:inline-block;text-align:left;background-color:#edeff2;padding:10px 20px;border-radius:3px;filter: alpha(Opacity=90);-moz-opacity: 0.9;opacity: 0.9;}
#directory li,#directory ul{margin:0;padding-left:0;list-style:none}
#directory>ul{position:relative;border-left:1px solid #ddd}
#directory>ul>li::before{position:relative;top:0;left:-4px;display:inline-block;width:7px;height:7px;content:'';border-radius:50%;background-color:#eb5055}
#directory ul li a{display:inline-table;margin-left:5px;white-space:nowrap}
#directory ul li ul li a{margin-left:20px;white-space:nowrap;color:#5f5f5f}
#directory ul li ul li ul li a{margin-left:30px;color:#5f5f5f}
#directory a:hover{color:#eb5055}
@media (max-width: 768px) {
    #directory p,ul {
        display: none;
    }
}
@media (max-width: 480px) {
    #directory p,ul {
        display: none;
    }
}
</style>
<div id="directory-content" class="directory-content">
    <div id="directory"></div>
</div>
<script type="text/javascript">
    $('#directory').html('<a id="openHiddenLinkId" href="javascript:void(0)" isopen="0" style="display:block;float:right;z-index: 2000;">↗</a><p style="margin: 0;text-align: center;padding-bottom: 5px;color: #08c;">目录</p>');
    var postDirectoryBuild = function() {
        $("#openHiddenLinkId").click(function(){
            var isopen = $(this).attr("isopen");
            if(isopen == "1"){
              $('#directory').find("p,ul").show(200);
              $(this).attr("isopen","0").html("↗");
            }else{
              $('#directory').find("p,ul").hide(200);
              $(this).attr("isopen","1").html("↙");
            }
        });
        var postChildren = function children(childNodes, reg) {
                var result = [],
                    isReg = typeof reg === 'object',
                    isStr = typeof reg === 'string',
                    node, i, len;
                for (i = 0, len = childNodes.length; i < len; i++) {
                    node = childNodes[i];
                    if ((node.nodeType === 1 || node.nodeType === 9) &&
                        (!reg ||
                        isReg && reg.test(node.tagName.toLowerCase()) ||
                        isStr && node.tagName.toLowerCase() === reg)) {
                        result.push(node);
                    }
                }
                return result;
            },
            createPostDirectory = function(article, directory, isDirNum) {
                var contentArr = [],
                    titleId = [],
                    levelArr, root, level,
                    currentList, list, li, link, i, len;
                levelArr = (function(article, contentArr, titleId) {
                    var titleElem = postChildren(article.childNodes, /^h\d$/),
                        levelArr = [],
                        lastNum = 1,
                        lastRevNum = 1,
                        count = 0,
                        guid = 1,
                        id = 'directory' + (Math.random() + '').replace(/\D/, ''),
                        lastRevNum, num, elem;
                    while (titleElem.length) {
                        elem = titleElem.shift();
                        contentArr.push(elem.innerHTML);
                        num = +elem.tagName.match(/\d/)[0];
                        if (num > lastNum) {
                            levelArr.push(1);
                            lastRevNum += 1;
                        } else if (num === lastRevNum ||
                            num > lastRevNum && num <= lastNum) {
                            levelArr.push(0);
                            lastRevNum = lastRevNum;
                        } else if (num < lastRevNum) {
                            levelArr.push(num - lastRevNum);
                            lastRevNum = num;
                        }
                        count += levelArr[levelArr.length - 1];
                        lastNum = num;
                        elem.id = elem.id || (id + guid++);
                        titleId.push(elem.id);
                    }
                    if (count !== 0 && levelArr[0] === 1) levelArr[0] = 0;

                    return levelArr;
                })(article, contentArr, titleId);
                currentList = root = document.createElement('ul');
                dirNum = [0];
                for (i = 0, len = levelArr.length; i < len; i++) {
                    level = levelArr[i];
                    if (level === 1) {
                        list = document.createElement('ul');
                        if (!currentList.lastElementChild) {
                            currentList.appendChild(document.createElement('li'));
                        }
                        currentList.lastElementChild.appendChild(list);
                        currentList = list;
                        dirNum.push(0);
                    } else if (level < 0) {
                        level *= 2;
                        while (level++) {
                            if (level % 2) dirNum.pop();
                            currentList = currentList.parentNode;
                        }
                    }
                    dirNum[dirNum.length - 1]++;
                    li = document.createElement('li');
                    link = document.createElement('a');
                    link.href = '#' + titleId[i];
                    link.innerHTML = !isDirNum ? contentArr[i] :
                        dirNum.join('.') + ' ' + contentArr[i] ;
                    li.appendChild(link);
                    currentList.appendChild(li);
                }
                directory.appendChild(root);
            };
        createPostDirectory(document.getElementById('articleBody'),document.getElementById('directory'), true);
    };
    postDirectoryBuild();
</script>




                    </div>
                </div>
            </div>
        </div>
        <footer class="the-footer">
    <div class="unit-foot">
        <div class="unit-inner unit-foot-inner">
            <div class="misc vcard">
                <div class="about">
                    <h4>
                        <a href="/blog/other/about/">关于</a>
                        
                    </h4>
                </div>
                <div class="social-links">
                    
                        <a class="ico-gmail" href="mailto:1460300366@qq.com" rel="me" target="_blank" title="email"></a>
                    
                    <a class="ico-rss" href="/feed.xml" rel="me" target="_blank" title="feed"></a>
                    
                        
                    
                        
                            <a class="ico-github" href="https://github.com/petterobam" rel="me" target="_blank" title="github"></a>
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                </div>
            </div>
        </div>
    </div>
    <a href="#" class="internal back-to-top">返回顶部</a>
</footer>


    </div>

    <script>
$(document).ready(function () {
    var offset = 50,
        duration = 500,
        width = 960;
    var dirOldTop = 37;
    $(window).scroll(function () {
    	var scrollTop = $(this).scrollTop();
        if (scrollTop > width) {
            if (scrollTop > offset) {
                $('footer').css('top', '20px');
                $('footer .back-to-top').fadeIn(duration);
            } else {
                $('footer').css('top', 'auto');
                $('footer .back-to-top').fadeOut(duration);
            }
        }
        var directory = $("#directory");
        if(null != directory && directory.length > 0){
        	var top;
        	if(scrollTop > dirOldTop){
        		top = (scrollTop - dirOldTop) + "px";
        	}else{
        		top = dirOldTop + "px";
        	}
        	directory.css("top",top);
        }
    });
    $(window).resize(function () {
        if ($(window).width() < width) {
            $('footer').css('top', 'auto');
            $('footer .back-to-top').fadeOut(duration);
        }
        if ($(window).width() >= width && $(this).scrollTop() > offset) {
            $('footer').css('top', '20px');
            $('footer .back-to-top').fadeIn(duration);
        }
    });

    $('footer .back-to-top, .gotop').on('click', function (event) {
        event.preventDefault();
        $('html, body').animate({
            scrollTop: 0
        }, duration);
        return false;
    });

    $('.show-hidden').on('click', function () {
        $(this).parent().next().toggleClass("hidden");
        $(this).toggleClass("hidden");
    });
});
</script>

<!-- Google Analytics Event tracking -->


<!-- Show menu overlay + Jekyll Simple Search option -->
<script src="/assets/javascripts/jekyll-search.jquery.js"></script>
<script>
$(document).ready(function () {
    $('.search-field').simpleJekyllSearch({
      jsonFile: '/search.json',
      template: '<li><a href="{url}">{title} <span class="entry-date"><time datetime="{date}">{shortdate}</time></span></a></li>',
      searchResults: '.search-wrapper .results',
      searchResultsTitle: '<h4>搜索结果</h4>',
      noResults: '<p>啊哈<br/><small>什么也没找到 :(</small></p>'
    });
});

(function ($, window, undefined) {
    var closeOverlay = function () {
        $('.nav-wrapper, .search-wrapper').removeAttr('style');
        $(".nav-form, .search-form").removeClass('active');
        $("body").removeClass('nav-overlay search-overlay');
    };

    $('.nav-global .btn-init-live2dgirl').on('click', function () {
        initLive2dGirl();
    });

    $('.nav-global .btn-search').on('click', function () {
        $('.search-wrapper').css({display: "block"});
        $(".search-form").addClass('active');
        $(".search-form").find('input').focus();
        $("body").addClass('search-overlay');
    });

    $('.nav-global .btn-menu').on('click', function () {
        $('.nav-wrapper').css({display: "block"});
        $(".nav-form").addClass('active');
        $(".nav-form .search-field").prop('disabled', true);
        $("body").addClass('nav-overlay');
    });

    $('.nav-wrapper .btn-close, .search-wrapper .btn-close').on('click', function () {
        closeOverlay();
    });

    $(document).on('keyup', function (e) {
        if (e.keyCode === 27) {
            closeOverlay();
        }
    });
})(jQuery, window);
</script>

<script src='//cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.4/jquery.fancybox.min.js'></script>
<script src='//cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.4/helpers/jquery.fancybox-buttons.min.js'></script>
<script src="/assets/javascripts/unveil/jquery.unveil.min.js"></script>

<script>
    window.jQuery.fancybox || document.write('<script src="/assets/javascripts/fancybox/jquery.fancybox.pack.js?v=2.1.4"><\/script>')
    window.jQuery.fancybox.helpers.buttons || document.write('<script src="/assets/javascripts/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"><\/script>')
</script>

<script>
    $("head").append('<link rel="stylesheet" href="/assets/javascripts/fancybox/jquery.fancybox.css?v=2.1.4" type="text/css" />');
    $("head").append('<link rel="stylesheet" href="/assets/javascripts/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5" type="text/css" />');
    $(".post-image").fancybox({
        prevEffect: 'none',
        nextEffect: 'none',
        closeBtn: true,
        helpers: {
            title: {
                type: 'float'
            }
        }
    });
    $(document).ready(function () {
        $(".post-image > img").unveil(450);
        $(".nav-global a[label='']").css("background-color", "orange")
    });
</script>

<!-- LaTeX 语法支持 -->
<script type="text/javascript" async
  src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML">
</script>

<!-- 动态隐藏 post 的 js -->
<style type="text/css">
  ul.post-list li.post2hide {
    display: none;
  }
</style>

<script text="text/javascript">
  $(document).ready(function() {
    // 获取URL参数
    const urlParams = new URLSearchParams(window.location.search);
    // 检查是否有action参数，并且其值为all
    if(urlParams.get('action') === 'all' || '' === 'all') {
      // 找到所有不可见的<li>元素并将其显示出来
      $('li.post2hide').show();
    }
  });
</script>
<!-- 折叠 post 列表 的 js -->


<!-- 图片点击预览 -->
<div id="imgEnlargeDiv" style="display: none; text-align: center;position: fixed;z-index: 1000;top: 0;left: 0;
    width: 100%;height: 100%;background-color: rgba(255,255,255,.9);overflow: hidden;">
    <img id="bigimg-random-12312" style="height: auto;width: 90%;
    position: absolute;margin:auto;top:0;bottom:0;left: 0;right: 0;" title="单击关闭图层" src="" />
</div>
<script type="text/javascript">
    // 图片放大  
    $(function () {
        $("#imgEnlargeDiv").click(function () {
            // 再次点击淡出消失弹出层    
            $(this).fadeOut("fast");
        });
        imgEnlarge();
    });

    function imgShow(outerdiv, bigimg, _this) {
        var src = _this.attr("src");// 获取当前点击的pimg元素中的src属性    
        $(bigimg).attr("src", src);// 设置#bigimg元素的src属性    
        $(outerdiv).fadeIn("fast");  // 图片放大的div快速淡入显示层
        var imgWidth = $(bigimg).width();
        var imgHeight = $(bigimg).height();
        if (imgHeight > imgWidth) {
            $(bigimg).css("height", "90%").css("width", "auto");
        } else {
            $(bigimg).css("height", "auto").css("width", "90%");
        }
    }

    var img2ShowExit = true;
    function imgEnlarge() {
        $(".entry-content img").mouseover(function () {
            $(this).css("cursor", "pointer");//鼠标移动到图片，鼠标箭头变为手势
        });
        $(".entry-content img").click(function () {
            var _this = $(this);// 将当前的pimg元素作为_this传入函数    
            imgShow("#imgEnlargeDiv", "#bigimg-random-12312", _this);
        });
    }
</script>
<!-- gist 引用折叠 -->
<script type="text/javascript">
$(function () {
    if (/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)) {
        // 是移动设备
        $(".gist-file").click(function() {
            if ($(this).attr("pack-up") == "1") {
                $(this).find(".gist-data").css({
                    "overflow": "auto",
                    "height": "auto",
                    "border-bottom": "1px solid #ddd"
                });
                $(this).find(".gist-meta span").html('&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ↑↑ 单击收起 ↑↑ &nbsp;&nbsp;&nbsp;');
                $(this).attr("pack-up", "0");
            } else {
                $(this).find(".gist-data").css({
                    "overflow": "hidden",
                    "height": "75px",
                    "border-bottom": "3px solid red"
                });
                $(this).find(".gist-meta span").html('&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ↑↑ 单击展开 ↑↑ &nbsp;&nbsp;&nbsp;');
                $(this).attr("pack-up", "1");
            }
        });
      } else {
        $(".gist-file").dblclick(function() {
            if ($(this).attr("pack-up") == "1") {
                $(this).find(".gist-data").css({
                    "overflow": "auto",
                    "height": "auto",
                    "border-bottom": "1px solid #ddd"
                });
                $(this).find(".gist-meta span").html('&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ↑↑ 双击收起 ↑↑ &nbsp;&nbsp;&nbsp;');
                $(this).attr("pack-up", "0");
            } else {
                $(this).find(".gist-data").css({
                    "overflow": "hidden",
                    "height": "75px",
                    "border-bottom": "3px solid red"
                });
                $(this).find(".gist-meta span").html('&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ↑↑ 双击展开 ↑↑ &nbsp;&nbsp;&nbsp;');
                $(this).attr("pack-up", "1");
            }
        });
    }

    $(".gist-file").find(".gist-data").css({
        "overflow": "hidden",
        "height": "75px",
        "border-bottom": "3px solid red"
    });
    $(".gist-file").attr("pack-up", "1");
    $(".gist-file").find(".gist-data").css({"cursor":"pointer"});
    $(".gist-file").find(".gist-meta").append('<span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ↑↑ 双击展开 ↑↑</span>');
});
</script>


<!-- live2dgirl加载 -->

<link rel="stylesheet" type="text/css" href="/assets/javascripts/live2dgirl/waifu.css"/>
<!-- <script src="/assets/javascripts/live2dgirl/jquery.min.js"></script> -->
<div class="waifu">
    <div class="waifu-tips"></div>
    <canvas id="live2d" width="280" height="250" class="live2d"></canvas>
    <div class="waifu-tool">
        <span class="fui-home"></span>
        <span class="fui-chat"></span>
        <span class="fui-eye"></span>
        <span class="fui-user"></span>
        <span class="fui-photo"></span>
        <span class="fui-info-circle"></span>
        <span class="fui-cross"></span>
    </div>
</div>
<script sync src="/assets/javascripts/live2dgirl/waifu-tips.js"></script>
<script sync src="/assets/javascripts/live2dgirl/live2d.js"></script>
<script type="text/javascript">
function initLive2dGirl() {
    $(".waifu").css('display', 'block');
    initModel("/assets/javascripts/live2dgirl/");
}
</script>


</body>

</html>